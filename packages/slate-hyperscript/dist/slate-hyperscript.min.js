!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("slate")):"function"==typeof define&&define.amd?define(["exports","slate"],t):t(e.SlateHyperscript={},e.Slate)}(this,function(e,t){"use strict";var n=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)};function o(e){return!0===n(e)&&"[object Object]"===Object.prototype.toString.call(e)}var r=function(e){var t,n;return!1!==o(e)&&("function"==typeof(t=e.constructor)&&(!1!==o(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))},a=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},c=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},s=function e(){a(this,e),this.offset=null},f=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e);var n=t.key,o=void 0===n?null:n,r=t.offset,i=void 0===r?null:r,c=t.path,s=void 0===c?null:c;this.key=o,this.offset=i,this.path=s},u=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e);var n=t.key,o=void 0===n?null:n,r=t.offset,i=void 0===r?null:r,c=t.path,s=void 0===c?null:c;this.key=o,this.offset=i,this.path=s},l=function e(n){var o=this;a(this,e),this.combine=function(n){if(!(n instanceof e))throw new Error("misaligned decorations");return t.Decoration.create({anchor:{key:o.key,offset:o.offset},focus:{key:n.key,offset:n.offset},mark:{type:o.type,data:o.data}})};var r=n.key,i=void 0===r?null:r,c=n.data,s=void 0===c?{}:c,f=n.type;this.id=i,this.offset=0,this.type=f,this.data=s},d={anchor:function(e,t,n){return new f(t)},block:function(e,n,o){return t.Block.create(i({},n,{nodes:y(o)}))},cursor:function(e,t,n){return new s},decoration:function(e,t,n){var o=t.key,r=t.data,a=e;if(o)return new l({key:o,type:a,data:r});var i=y(n),c=i[0],s=c.__decorations,f=void 0===s?[]:s,u={anchorOffset:0,focusOffset:i.reduce(function(e,t){return e+t.text.length},0),type:a,data:r};return f.push(u),c.__decorations=f,i},document:function(e,n,o){return t.Document.create(i({},n,{nodes:y(o)}))},focus:function(e,t,n){return new u(t)},inline:function(e,n,o){return t.Inline.create(i({},n,{nodes:y(o)}))},mark:function(e,n,o){return y(o,{marks:t.Mark.createSet([n])})},selection:function(e,n,o){var r=o.find(function(e){return e instanceof f}),a=o.find(function(e){return e instanceof u}),i=n.marks,c=n.focused,s=t.Selection.create({marks:i,isFocused:c,anchor:r&&{key:r.key,offset:r.offset,path:r.path},focus:a&&{key:a.key,offset:a.offset,path:a.path}});return s},text:function(e,t,n){return y(n,{key:t.key})},value:function(e,n,o){var r=n.data,a=n.normalize,c=void 0===a||a,s=o.find(t.Document.isDocument),f=o.find(t.Selection.isSelection)||t.Selection.create(),u=void 0,l=void 0,d=[],h={};if(s&&s.getTexts().forEach(function(e){null!=e.__anchor&&(u=t.Point.create({key:e.key,offset:e.__anchor.offset})),null!=e.__focus&&(l=t.Point.create({key:e.key,offset:e.__focus.offset})),null!=e.__decorations&&e.__decorations.forEach(function(n){var o=n.id,r=void 0;if(o)if(h[o]){var a=h[o];delete h[o],r=t.Decoration.create({anchor:{key:a.key,offset:a.offset},focus:{key:e.key,offset:n.offset},mark:{type:n.type,data:n.data}})}else n.key=e.key,h[o]=n;else r=t.Decoration.create({anchor:{key:e.key,offset:n.anchorOffset},focus:{key:e.key,offset:n.focusOffset},mark:{type:n.type,data:n.data}});r&&d.push(r)})}),Object.keys(h).length>0)throw new Error("Slate hyperscript must have both a start and an end defined for each decoration using the `key=` prop.");if(u&&!l)throw new Error("Slate hyperscript ranges must have both `<anchor />` and `<focus />` defined if one is defined, but you only defined `<anchor />`. For collapsed selections, use `<cursor />` instead.");if(!u&&l)throw new Error("Slate hyperscript ranges must have both `<anchor />` and `<focus />` defined if one is defined, but you only defined `<focus />`. For collapsed selections, use `<cursor />` instead.");var y=t.Value.fromJSON(i({data:r,document:s,selection:f},n),{normalize:c});return(u||l)&&(f=(f=(f=f.setPoints([u,l])).setIsFocused(!0)).normalize(y.document),y=y.set("selection",f)),d.length>0&&(d=d.map(function(e){return e.normalize(y.document)}),d=t.Decoration.createList(d),y=y.set("decorations",d)),y}};function h(){var e=function(e){var t=e.blocks,n=void 0===t?{}:t,o=e.inlines,a=void 0===o?{}:o,c=e.marks,s=void 0===c?{}:c,f=e.decorations,u=void 0===f?{}:f,l=e.schema,h=i({},d,e.creators||{});return Object.keys(n).map(function(e){h[e]=p(n[e],"block")}),Object.keys(a).map(function(e){h[e]=p(a[e],"inline")}),Object.keys(s).map(function(e){h[e]=function(e){if("function"==typeof e)return e;if("string"==typeof e&&(e={type:e}),r(e))return function(t,n,o){var r=i({},e,{data:i({},e.data||{},n)});return d.mark(t,r,o)};throw new Error("Slate hyperscript mark creators can be either functions, objects or strings, but you passed: "+e)}(s[e])}),Object.keys(u).map(function(e){h[e]=p(u[e],"decoration")}),h.value=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2],o=i({schema:l},t);return d.value(e,o,n)},h}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return function(t,n){for(var o=arguments.length,a=Array(o>2?o-2:0),i=2;i<o;i++)a[i-2]=arguments[i];var c=e[t];if(!c)throw new Error('No hyperscript creator found for tag: "'+t+'"');return null==n&&(n={}),r(n)||(a=[n].concat(a),n={}),c(t,n,a=a.filter(function(e){return Boolean(e)}).reduce(function(e,t){return e.concat(t)},[]))}}function y(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=[],r=0,a=e.find(function(e){return"string"!=typeof e}),i=t.Text.isText(a)?a:null,c=n.key?n.key:i?i.key:void 0,d=t.Text.create({key:c,leaves:[{text:"",marks:n.marks}]});function h(e){var t=d,n=t.__anchor,o=t.__focus,r=t.__decorations;null!=n&&(e.__anchor=n),null!=o&&(e.__focus=o),null!=r&&(e.__decorations=r),d=e}return e.forEach(function(a,i){var c=i===e.length-1;if(t.Node.isNode(a)&&!t.Text.isText(a)&&((d.text.length||null!=d.__anchor||null!=d.__focus||d.getMarksAtIndex(0).size)&&o.push(d),o.push(a),d=c?null:t.Text.create({leaves:[{text:"",marks:n.marks}]}),r=0),"string"==typeof a&&(h(d.insertText(d.text.length,a,n.marks)),r+=a.length),t.Text.isText(a)){var y=a.__anchor,p=a.__focus,k=a.__decorations,_=d.text.length;n.key||0!=d.text.length||h(d.set("key",a.key)),a.getLeaves().forEach(function(e){var t=e.marks;n.marks&&(t=t.union(n.marks)),h(d.insertText(_,e.text,t)),_+=e.text.length}),null!=y&&(d.__anchor=new f,d.__anchor.offset=y.offset+r),null!=p&&(d.__focus=new u,d.__focus.offset=p.offset+r),null!=k&&(k.forEach(function(e){e instanceof l?e.offset+=r:(e.anchorOffset+=r,e.focusOffset+=r)}),d.__decorations=d.__decorations||[],d.__decorations=d.__decorations.concat(k)),r+=a.text.length}(a instanceof f||a instanceof s)&&(a.offset=r,d.__anchor=a),(a instanceof u||a instanceof s)&&(a.offset=r,d.__focus=a),a instanceof l&&(a.offset=r,d.__decorations=d.__decorations||[],d.__decorations=d.__decorations.concat(a))}),null!=d&&o.push(d),o}function p(e,t){if("function"==typeof e)return e;if("string"==typeof e&&(e={type:e}),r(e))return function(n,o,r){var a=o.key,s=c(o,["key"]),f=i({},e,{object:t,key:a,data:i({},e.data||{},s)});return d[t](n,f,r)};throw new Error("Slate hyperscript "+t+" creators can be either functions, objects or strings, but you passed: "+e)}var k=h();e.default=k,e.createHyperscript=h,Object.defineProperty(e,"__esModule",{value:!0})});
